<meta charset="utf-8" /><meta name="hf:doc:metadata" content="{&quot;title&quot;:&quot;ì‚¬ìš©ì ì •ì˜ ëª¨ë¸ ê³µìœ í•˜ê¸°&quot;,&quot;local&quot;:&quot;sharing-custom-models&quot;,&quot;sections&quot;:[{&quot;title&quot;:&quot;ì‚¬ìš©ì ì •ì˜ êµ¬ì„± ì‘ì„±í•˜ê¸°&quot;,&quot;local&quot;:&quot;writing-a-custom-configuration&quot;,&quot;sections&quot;:[],&quot;depth&quot;:2},{&quot;title&quot;:&quot;ì‚¬ìš©ì ì •ì˜ ëª¨ë¸ ì‘ì„±í•˜ê¸°&quot;,&quot;local&quot;:&quot;writing-a-custom-model&quot;,&quot;sections&quot;:[],&quot;depth&quot;:2},{&quot;title&quot;:&quot;Hubë¡œ ì½”ë“œ ì—…ë¡œë“œí•˜ê¸°&quot;,&quot;local&quot;:&quot;sending-the-code-to-the-hub&quot;,&quot;sections&quot;:[],&quot;depth&quot;:2},{&quot;title&quot;:&quot;ì‚¬ìš©ì ì •ì˜ ì½”ë“œë¡œ ëª¨ë¸ ì‚¬ìš©í•˜ê¸°&quot;,&quot;local&quot;:&quot;using-a-model-with-custom-code&quot;,&quot;sections&quot;:[],&quot;depth&quot;:2},{&quot;title&quot;:&quot;ì‚¬ìš©ì ì •ì˜ ì½”ë“œë¡œ ë§Œë“  ëª¨ë¸ì„ auto í´ë˜ìŠ¤ë¡œ ë“±ë¡í•˜ê¸°&quot;,&quot;local&quot;:&quot;registering-a-model-with-custom-code-to-the-auto-classes&quot;,&quot;sections&quot;:[],&quot;depth&quot;:2}],&quot;depth&quot;:1}">
		<link href="/docs/transformers/main/ko/_app/immutable/assets/0.e3b0c442.css" rel="modulepreload">
		<link rel="modulepreload" href="/docs/transformers/main/ko/_app/immutable/entry/start.b52dcfcd.js">
		<link rel="modulepreload" href="/docs/transformers/main/ko/_app/immutable/chunks/scheduler.56730f09.js">
		<link rel="modulepreload" href="/docs/transformers/main/ko/_app/immutable/chunks/singletons.394dd9a4.js">
		<link rel="modulepreload" href="/docs/transformers/main/ko/_app/immutable/chunks/index.bdfeb96e.js">
		<link rel="modulepreload" href="/docs/transformers/main/ko/_app/immutable/chunks/paths.538504d0.js">
		<link rel="modulepreload" href="/docs/transformers/main/ko/_app/immutable/entry/app.9c1dbc76.js">
		<link rel="modulepreload" href="/docs/transformers/main/ko/_app/immutable/chunks/index.1f144517.js">
		<link rel="modulepreload" href="/docs/transformers/main/ko/_app/immutable/nodes/0.cc7e2a6a.js">
		<link rel="modulepreload" href="/docs/transformers/main/ko/_app/immutable/chunks/each.e59479a4.js">
		<link rel="modulepreload" href="/docs/transformers/main/ko/_app/immutable/nodes/13.39ff2cae.js">
		<link rel="modulepreload" href="/docs/transformers/main/ko/_app/immutable/chunks/Tip.41e845e5.js">
		<link rel="modulepreload" href="/docs/transformers/main/ko/_app/immutable/chunks/CodeBlock.738eeccb.js">
		<link rel="modulepreload" href="/docs/transformers/main/ko/_app/immutable/chunks/Heading.57d46534.js"><!-- HEAD_svelte-u9bgzb_START --><meta name="hf:doc:metadata" content="{&quot;title&quot;:&quot;ì‚¬ìš©ì ì •ì˜ ëª¨ë¸ ê³µìœ í•˜ê¸°&quot;,&quot;local&quot;:&quot;sharing-custom-models&quot;,&quot;sections&quot;:[{&quot;title&quot;:&quot;ì‚¬ìš©ì ì •ì˜ êµ¬ì„± ì‘ì„±í•˜ê¸°&quot;,&quot;local&quot;:&quot;writing-a-custom-configuration&quot;,&quot;sections&quot;:[],&quot;depth&quot;:2},{&quot;title&quot;:&quot;ì‚¬ìš©ì ì •ì˜ ëª¨ë¸ ì‘ì„±í•˜ê¸°&quot;,&quot;local&quot;:&quot;writing-a-custom-model&quot;,&quot;sections&quot;:[],&quot;depth&quot;:2},{&quot;title&quot;:&quot;Hubë¡œ ì½”ë“œ ì—…ë¡œë“œí•˜ê¸°&quot;,&quot;local&quot;:&quot;sending-the-code-to-the-hub&quot;,&quot;sections&quot;:[],&quot;depth&quot;:2},{&quot;title&quot;:&quot;ì‚¬ìš©ì ì •ì˜ ì½”ë“œë¡œ ëª¨ë¸ ì‚¬ìš©í•˜ê¸°&quot;,&quot;local&quot;:&quot;using-a-model-with-custom-code&quot;,&quot;sections&quot;:[],&quot;depth&quot;:2},{&quot;title&quot;:&quot;ì‚¬ìš©ì ì •ì˜ ì½”ë“œë¡œ ë§Œë“  ëª¨ë¸ì„ auto í´ë˜ìŠ¤ë¡œ ë“±ë¡í•˜ê¸°&quot;,&quot;local&quot;:&quot;registering-a-model-with-custom-code-to-the-auto-classes&quot;,&quot;sections&quot;:[],&quot;depth&quot;:2}],&quot;depth&quot;:1}"><!-- HEAD_svelte-u9bgzb_END -->      <p></p>   <h1 class="relative group"><a id="sharing-custom-models" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#sharing-custom-models"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a> <span>ì‚¬ìš©ì ì •ì˜ ëª¨ë¸ ê³µìœ í•˜ê¸°</span></h1> <p data-svelte-h="svelte-al07n">ğŸ¤— Transformers ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ì‰½ê²Œ í™•ì¥í•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.
ëª¨ë“  ëª¨ë¸ì€ ì¶”ìƒí™” ì—†ì´ ì €ì¥ì†Œì˜ ì§€ì •ëœ í•˜ìœ„ í´ë”ì— ì™„ì „íˆ ì½”ë”©ë˜ì–´ ìˆìœ¼ë¯€ë¡œ, ì†ì‰½ê²Œ ëª¨ë¸ë§ íŒŒì¼ì„ ë³µì‚¬í•˜ê³  í•„ìš”ì— ë”°ë¼ ì¡°ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p> <p data-svelte-h="svelte-1lxcxix">ì™„ì „íˆ ìƒˆë¡œìš´ ëª¨ë¸ì„ ë§Œë“œëŠ” ê²½ìš°ì—ëŠ” ì²˜ìŒë¶€í„° ì‹œì‘í•˜ëŠ” ê²ƒì´ ë” ì‰¬ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì´ íŠœí† ë¦¬ì–¼ì—ì„œëŠ” Transformers ë‚´ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì‚¬ìš©ì ì •ì˜ ëª¨ë¸ê³¼ êµ¬ì„±ì„ ì‘ì„±í•˜ëŠ” ë°©ë²•ê³¼
ğŸ¤— Transformers ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ì—†ëŠ” ê²½ìš°ì—ë„ ëˆ„êµ¬ë‚˜ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ (ì˜ì¡´ì„±ê³¼ í•¨ê»˜) ì»¤ë®¤ë‹ˆí‹°ì— ê³µìœ í•˜ëŠ” ë°©ë²•ì„ ë°°ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p> <p data-svelte-h="svelte-119rg2w"><a href="https://github.com/rwightman/pytorch-image-models" rel="nofollow">timm ë¼ì´ë¸ŒëŸ¬ë¦¬</a>ì˜ ResNet í´ë˜ìŠ¤ë¥¼ <code>PreTrainedModel</code>ë¡œ ë˜í•‘í•œ ResNet ëª¨ë¸ì„ ì˜ˆë¡œ ëª¨ë“  ê²ƒì„ ì„¤ëª…í•©ë‹ˆë‹¤.</p>  <h2 class="relative group"><a id="writing-a-custom-configuration" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#writing-a-custom-configuration"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a> <span>ì‚¬ìš©ì ì •ì˜ êµ¬ì„± ì‘ì„±í•˜ê¸°</span></h2> <p data-svelte-h="svelte-la43mp">ëª¨ë¸ì— ë“¤ì–´ê°€ê¸° ì „ì— ë¨¼ì € êµ¬ì„±ì„ ì‘ì„±í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.
ëª¨ë¸ì˜ <code>configuration</code>ì€ ëª¨ë¸ì„ ë§Œë“¤ê¸° ìœ„í•´ í•„ìš”í•œ ëª¨ë“  ì¤‘ìš”í•œ ê²ƒë“¤ì„ í¬í•¨í•˜ê³  ìˆëŠ” ê°ì²´ì…ë‹ˆë‹¤.
ë‹¤ìŒ ì„¹ì…˜ì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ì´, ëª¨ë¸ì€ <code>config</code>ë¥¼ ì‚¬ìš©í•´ì„œë§Œ ì´ˆê¸°í™”í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì™„ë²½í•œ êµ¬ì„±ì´ í•„ìš”í•©ë‹ˆë‹¤.</p> <p data-svelte-h="svelte-1qc22zw">ì•„ë˜ ì˜ˆì‹œì—ì„œëŠ” ResNet í´ë˜ìŠ¤ì˜ ì¸ìˆ˜(argument)ë¥¼ ì¡°ì •í•´ë³´ê² ìŠµë‹ˆë‹¤.
ë‹¤ë¥¸ êµ¬ì„±ì€ ê°€ëŠ¥í•œ ResNet ì¤‘ ë‹¤ë¥¸ ìœ í˜•ì„ ì œê³µí•©ë‹ˆë‹¤.
ê·¸ëŸ° ë‹¤ìŒ ëª‡ ê°€ì§€ ìœ íš¨ì„±ì„ í™•ì¸í•œ í›„ í•´ë‹¹ ì¸ìˆ˜ë¥¼ ì €ì¥í•©ë‹ˆë‹¤.</p> <div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg> <div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div> Copied</div></button></div> <pre class=""><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> PretrainedConfig
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span>


<span class="hljs-keyword">class</span> <span class="hljs-title class_">ResnetConfig</span>(<span class="hljs-title class_ inherited__">PretrainedConfig</span>):
    model_type = <span class="hljs-string">&quot;resnet&quot;</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">
        self,
        block_type=<span class="hljs-string">&quot;bottleneck&quot;</span>,
        layers: <span class="hljs-type">List</span>[<span class="hljs-built_in">int</span>] = [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>],
        num_classes: <span class="hljs-built_in">int</span> = <span class="hljs-number">1000</span>,
        input_channels: <span class="hljs-built_in">int</span> = <span class="hljs-number">3</span>,
        cardinality: <span class="hljs-built_in">int</span> = <span class="hljs-number">1</span>,
        base_width: <span class="hljs-built_in">int</span> = <span class="hljs-number">64</span>,
        stem_width: <span class="hljs-built_in">int</span> = <span class="hljs-number">64</span>,
        stem_type: <span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;&quot;</span>,
        avg_down: <span class="hljs-built_in">bool</span> = <span class="hljs-literal">False</span>,
        **kwargs,
    </span>):
        <span class="hljs-keyword">if</span> block_type <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> [<span class="hljs-string">&quot;basic&quot;</span>, <span class="hljs-string">&quot;bottleneck&quot;</span>]:
            <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">f&quot;`block_type` must be &#x27;basic&#x27; or bottleneck&#x27;, got <span class="hljs-subst">{block_type}</span>.&quot;</span>)
        <span class="hljs-keyword">if</span> stem_type <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> [<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;deep&quot;</span>, <span class="hljs-string">&quot;deep-tiered&quot;</span>]:
            <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">f&quot;`stem_type` must be &#x27;&#x27;, &#x27;deep&#x27; or &#x27;deep-tiered&#x27;, got <span class="hljs-subst">{stem_type}</span>.&quot;</span>)

        self.block_type = block_type
        self.layers = layers
        self.num_classes = num_classes
        self.input_channels = input_channels
        self.cardinality = cardinality
        self.base_width = base_width
        self.stem_width = stem_width
        self.stem_type = stem_type
        self.avg_down = avg_down
        <span class="hljs-built_in">super</span>().__init__(**kwargs)<!-- HTML_TAG_END --></pre></div> <p data-svelte-h="svelte-nxq6mo">ì‚¬ìš©ì ì •ì˜ <code>configuration</code>ì„ ì‘ì„±í•  ë•Œ ê¸°ì–µí•´ì•¼ í•  ì„¸ ê°€ì§€ ì¤‘ìš”í•œ ì‚¬í•­ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:</p> <ul data-svelte-h="svelte-1tfxli8"><li><code>PretrainedConfig</code>ì„ ìƒì†í•´ì•¼ í•©ë‹ˆë‹¤.</li> <li><code>PretrainedConfig</code>ì˜ <code>__init__</code>ì€ ëª¨ë“  kwargsë¥¼ í—ˆìš©í•´ì•¼ í•˜ê³ ,</li> <li>ì´ëŸ¬í•œ <code>kwargs</code>ëŠ” ìƒìœ„ í´ë˜ìŠ¤ <code>__init__</code>ì— ì „ë‹¬ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.</li></ul> <p data-svelte-h="svelte-x5ckqo">ìƒì†ì€ ğŸ¤— Transformers ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ëª¨ë“  ê¸°ëŠ¥ì„ ê°€ì ¸ì˜¤ëŠ” ê²ƒì…ë‹ˆë‹¤.
ì´ëŸ¬í•œ ì ìœ¼ë¡œë¶€í„° ë¹„ë¡¯ë˜ëŠ” ë‘ ê°€ì§€ ì œì•½ ì¡°ê±´ì€ <code>PretrainedConfig</code>ì— ì„¤ì •í•˜ëŠ” ê²ƒë³´ë‹¤ ë” ë§ì€ í•„ë“œê°€ ìˆìŠµë‹ˆë‹¤.
<code>from_pretrained</code> ë©”ì„œë“œë¡œ êµ¬ì„±ì„ ë‹¤ì‹œ ë¡œë“œí•  ë•Œ í•´ë‹¹ í•„ë“œëŠ” êµ¬ì„±ì—ì„œ ìˆ˜ë½í•œ í›„ ìƒìœ„ í´ë˜ìŠ¤ë¡œ ë³´ë‚´ì•¼ í•©ë‹ˆë‹¤.</p> <p data-svelte-h="svelte-1kaub1g">ëª¨ë¸ì„ auto í´ë˜ìŠ¤ì— ë“±ë¡í•˜ì§€ ì•ŠëŠ” í•œ, <code>configuration</code>ì—ì„œ <code>model_type</code>ì„ ì •ì˜(ì—¬ê¸°ì„œ <code>model_type=&quot;resnet&quot;</code>)í•˜ëŠ” ê²ƒì€ í•„ìˆ˜ ì‚¬í•­ì´ ì•„ë‹™ë‹ˆë‹¤ (ë§ˆì§€ë§‰ ì„¹ì…˜ ì°¸ì¡°).</p> <p data-svelte-h="svelte-ovl0zx">ì´ë ‡ê²Œ í•˜ë©´ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ë‹¤ë¥¸ ëª¨ë¸ êµ¬ì„±ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ êµ¬ì„±ì„ ì‰½ê²Œ ë§Œë“¤ê³  ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ë‹¤ìŒì€ resnet50d êµ¬ì„±ì„ ìƒì„±í•˜ê³  ì €ì¥í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤:</p> <div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg> <div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div> Copied</div></button></div> <pre class=""><!-- HTML_TAG_START -->resnet50d_config = ResnetConfig(block_type=<span class="hljs-string">&quot;bottleneck&quot;</span>, stem_width=<span class="hljs-number">32</span>, stem_type=<span class="hljs-string">&quot;deep&quot;</span>, avg_down=<span class="hljs-literal">True</span>)
resnet50d_config.save_pretrained(<span class="hljs-string">&quot;custom-resnet&quot;</span>)<!-- HTML_TAG_END --></pre></div> <p data-svelte-h="svelte-d1xscf">ì´ë ‡ê²Œ í•˜ë©´ <code>custom-resnet</code> í´ë” ì•ˆì— <code>config.json</code>ì´ë¼ëŠ” íŒŒì¼ì´ ì €ì¥ë©ë‹ˆë‹¤.
ê·¸ëŸ° ë‹¤ìŒ <code>from_pretrained</code> ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬ì„±ì„ ë‹¤ì‹œ ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p> <div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg> <div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div> Copied</div></button></div> <pre class=""><!-- HTML_TAG_START -->resnet50d_config = ResnetConfig.from_pretrained(<span class="hljs-string">&quot;custom-resnet&quot;</span>)<!-- HTML_TAG_END --></pre></div> <p data-svelte-h="svelte-g1m52h">êµ¬ì„±ì„ Hubì— ì§ì ‘ ì—…ë¡œë“œí•˜ê¸° ìœ„í•´ <code>PretrainedConfig</code> í´ë˜ìŠ¤ì˜ <code>push_to_hub()</code>ì™€ ê°™ì€ ë‹¤ë¥¸ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>  <h2 class="relative group"><a id="writing-a-custom-model" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#writing-a-custom-model"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a> <span>ì‚¬ìš©ì ì •ì˜ ëª¨ë¸ ì‘ì„±í•˜ê¸°</span></h2> <p data-svelte-h="svelte-6nuh70">ì´ì œ ResNet êµ¬ì„±ì´ ìˆìœ¼ë¯€ë¡œ ëª¨ë¸ì„ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì‹¤ì œë¡œëŠ” ë‘ ê°œë¥¼ ì‘ì„±í•  ê²ƒì…ë‹ˆë‹¤. í•˜ë‚˜ëŠ” ì´ë¯¸ì§€ ë°°ì¹˜ì—ì„œ hidden featuresë¥¼ ì¶”ì¶œí•˜ëŠ” ê²ƒ(<code>BertModel</code>ê³¼ ê°™ì´), ë‹¤ë¥¸ í•˜ë‚˜ëŠ” ì´ë¯¸ì§€ ë¶„ë¥˜ì— ì í•©í•œ ê²ƒì…ë‹ˆë‹¤(<code>BertForSequenceClassification</code>ê³¼ ê°™ì´).</p> <p data-svelte-h="svelte-1ufn8h6">ì´ì „ì— ì–¸ê¸‰í–ˆë“¯ì´ ì´ ì˜ˆì œì—ì„œëŠ” ë‹¨ìˆœí•˜ê²Œ í•˜ê¸° ìœ„í•´ ëª¨ë¸ì˜ ëŠìŠ¨í•œ ë˜í¼(loose wrapper)ë§Œ ì‘ì„±í•  ê²ƒì…ë‹ˆë‹¤.
ì´ í´ë˜ìŠ¤ë¥¼ ì‘ì„±í•˜ê¸° ì „ì— ë¸”ë¡ ìœ í˜•ê³¼ ì‹¤ì œ ë¸”ë¡ í´ë˜ìŠ¤ ê°„ì˜ ë§¤í•‘ ì‘ì—…ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤.
ê·¸ëŸ° ë‹¤ìŒ <code>ResNet</code> í´ë˜ìŠ¤ë¡œ ì „ë‹¬ë˜ì–´ <code>configuration</code>ì„ í†µí•´ ëª¨ë¸ì´ ì„ ì–¸ë©ë‹ˆë‹¤:</p> <div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg> <div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div> Copied</div></button></div> <pre class=""><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> PreTrainedModel
<span class="hljs-keyword">from</span> timm.models.resnet <span class="hljs-keyword">import</span> BasicBlock, Bottleneck, ResNet
<span class="hljs-keyword">from</span> .configuration_resnet <span class="hljs-keyword">import</span> ResnetConfig


BLOCK_MAPPING = {<span class="hljs-string">&quot;basic&quot;</span>: BasicBlock, <span class="hljs-string">&quot;bottleneck&quot;</span>: Bottleneck}


<span class="hljs-keyword">class</span> <span class="hljs-title class_">ResnetModel</span>(<span class="hljs-title class_ inherited__">PreTrainedModel</span>):
    config_class = ResnetConfig

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, config</span>):
        <span class="hljs-built_in">super</span>().__init__(config)
        block_layer = BLOCK_MAPPING[config.block_type]
        self.model = ResNet(
            block_layer,
            config.layers,
            num_classes=config.num_classes,
            in_chans=config.input_channels,
            cardinality=config.cardinality,
            base_width=config.base_width,
            stem_width=config.stem_width,
            stem_type=config.stem_type,
            avg_down=config.avg_down,
        )

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, tensor</span>):
        <span class="hljs-keyword">return</span> self.model.forward_features(tensor)<!-- HTML_TAG_END --></pre></div> <p data-svelte-h="svelte-10szka3">ì´ë¯¸ì§€ ë¶„ë¥˜ ëª¨ë¸ì„ ë§Œë“¤ê¸° ìœ„í•´ì„œëŠ” forward ë©”ì†Œë“œë§Œ ë³€ê²½í•˜ë©´ ë©ë‹ˆë‹¤:</p> <div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg> <div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div> Copied</div></button></div> <pre class=""><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> torch


<span class="hljs-keyword">class</span> <span class="hljs-title class_">ResnetModelForImageClassification</span>(<span class="hljs-title class_ inherited__">PreTrainedModel</span>):
    config_class = ResnetConfig

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, config</span>):
        <span class="hljs-built_in">super</span>().__init__(config)
        block_layer = BLOCK_MAPPING[config.block_type]
        self.model = ResNet(
            block_layer,
            config.layers,
            num_classes=config.num_classes,
            in_chans=config.input_channels,
            cardinality=config.cardinality,
            base_width=config.base_width,
            stem_width=config.stem_width,
            stem_type=config.stem_type,
            avg_down=config.avg_down,
        )

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, tensor, labels=<span class="hljs-literal">None</span></span>):
        logits = self.model(tensor)
        <span class="hljs-keyword">if</span> labels <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:
            loss = torch.nn.cross_entropy(logits, labels)
            <span class="hljs-keyword">return</span> {<span class="hljs-string">&quot;loss&quot;</span>: loss, <span class="hljs-string">&quot;logits&quot;</span>: logits}
        <span class="hljs-keyword">return</span> {<span class="hljs-string">&quot;logits&quot;</span>: logits}<!-- HTML_TAG_END --></pre></div> <p data-svelte-h="svelte-1g3ya33">ë‘ ê²½ìš° ëª¨ë‘ <code>PreTrainedModel</code>ë¥¼ ìƒì†ë°›ê³ , <code>config</code>ë¥¼ í†µí•´ ìƒìœ„ í´ë˜ìŠ¤ ì´ˆê¸°í™”ë¥¼ í˜¸ì¶œí•˜ë‹¤ëŠ” ì ì„ ê¸°ì–µí•˜ì„¸ìš” (ì¼ë°˜ì ì¸ <code>torch.nn.Module</code>ì„ ì‘ì„±í•  ë•Œì™€ ë¹„ìŠ·í•¨).
ëª¨ë¸ì„ auto í´ë˜ìŠ¤ì— ë“±ë¡í•˜ê³  ì‹¶ì€ ê²½ìš°ì—ëŠ” <code>config_class</code>ë¥¼ ì„¤ì •í•˜ëŠ” ë¶€ë¶„ì´ í•„ìˆ˜ì…ë‹ˆë‹¤ (ë§ˆì§€ë§‰ ì„¹ì…˜ ì°¸ì¡°).</p>  <div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p data-svelte-h="svelte-hf6zh1">ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ì¡´ì¬í•˜ëŠ” ëª¨ë¸ê³¼ êµ‰ì¥íˆ ìœ ì‚¬í•˜ë‹¤ë©´, ëª¨ë¸ì„ ìƒì„±í•  ë•Œ êµ¬ì„±ì„ ì°¸ì¡°í•´ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p></div> <p data-svelte-h="svelte-1f99hcg">ì›í•˜ëŠ” ê²ƒì„ ëª¨ë¸ì´ ë°˜í™˜í•˜ë„ë¡ í•  ìˆ˜ ìˆì§€ë§Œ, <code>ResnetModelForImageClassification</code>ì—ì„œ í–ˆë˜ ê²ƒ ì²˜ëŸ¼
ë ˆì´ë¸”ì„ í†µê³¼ì‹œì¼°ì„ ë•Œ ì†ì‹¤ê³¼ í•¨ê»˜ ì‚¬ì „ í˜•íƒœë¡œ ë°˜í™˜í•˜ëŠ” ê²ƒì´ <code>Trainer</code> í´ë˜ìŠ¤ ë‚´ì—ì„œ ì§ì ‘ ëª¨ë¸ì„ ì‚¬ìš©í•˜ê¸°ì— ìœ ìš©í•©ë‹ˆë‹¤.
ìì‹ ë§Œì˜ í•™ìŠµ ë£¨í”„ ë˜ëŠ” ë‹¤ë¥¸ í•™ìŠµ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•  ê³„íšì´ë¼ë©´ ë‹¤ë¥¸ ì¶œë ¥ í˜•ì‹ì„ ì‚¬ìš©í•´ë„ ì¢‹ìŠµë‹ˆë‹¤.</p> <p data-svelte-h="svelte-68rs2x">ì´ì œ ëª¨ë¸ í´ë˜ìŠ¤ê°€ ìˆìœ¼ë¯€ë¡œ í•˜ë‚˜ ìƒì„±í•´ ë³´ê² ìŠµë‹ˆë‹¤:</p> <div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg> <div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div> Copied</div></button></div> <pre class=""><!-- HTML_TAG_START -->resnet50d = ResnetModelForImageClassification(resnet50d_config)<!-- HTML_TAG_END --></pre></div> <p data-svelte-h="svelte-10d07s4">ë‹¤ì‹œ ë§í•˜ì§€ë§Œ, <code>save_pretrained()</code>ë˜ëŠ” <code>push_to_hub()</code>ì²˜ëŸ¼ <code>PreTrainedModel</code>ì— ì†í•˜ëŠ” ëª¨ë“  ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ë‹¤ìŒ ì„¹ì…˜ì—ì„œ ë‘ ë²ˆì§¸ ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•´ ëª¨ë¸ ì½”ë“œì™€ ëª¨ë¸ ê°€ì¤‘ì¹˜ë¥¼ ì—…ë¡œë“œí•˜ëŠ” ë°©ë²•ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.
ë¨¼ì €, ëª¨ë¸ ë‚´ë¶€ì— ì‚¬ì „ í›ˆë ¨ëœ ê°€ì¤‘ì¹˜ë¥¼ ë¡œë“œí•´ ë³´ê² ìŠµë‹ˆë‹¤.</p> <p data-svelte-h="svelte-1319e67">ì´ ì˜ˆì œë¥¼ í™œìš©í•  ë•ŒëŠ”, ì‚¬ìš©ì ì •ì˜ ëª¨ë¸ì„ ìì‹ ë§Œì˜ ë°ì´í„°ë¡œ í•™ìŠµì‹œí‚¬ ê²ƒì…ë‹ˆë‹¤.
ì´ íŠœí† ë¦¬ì–¼ì—ì„œëŠ” ë¹ ë¥´ê²Œ ì§„í–‰í•˜ê¸° ìœ„í•´ ì‚¬ì „ í›ˆë ¨ëœ resnet50dë¥¼ ì‚¬ìš©í•˜ê² ìŠµë‹ˆë‹¤.
ì•„ë˜ ëª¨ë¸ì€ resnet50dì˜ ë˜í¼ì´ê¸° ë•Œë¬¸ì—, ê°€ì¤‘ì¹˜ë¥¼ ì‰½ê²Œ ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p> <div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg> <div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div> Copied</div></button></div> <pre class=""><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> timm

pretrained_model = timm.create_model(<span class="hljs-string">&quot;resnet50d&quot;</span>, pretrained=<span class="hljs-literal">True</span>)
resnet50d.model.load_state_dict(pretrained_model.state_dict())<!-- HTML_TAG_END --></pre></div> <p data-svelte-h="svelte-rtsgc0">ì´ì œ <code>save_pretrained()</code> ë˜ëŠ” <code>push_to_hub()</code>ë¥¼ ì‚¬ìš©í•  ë•Œ ëª¨ë¸ ì½”ë“œê°€ ì €ì¥ë˜ëŠ”ì§€ í™•ì¸í•´ë´…ì‹œë‹¤.</p>  <h2 class="relative group"><a id="sending-the-code-to-the-hub" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#sending-the-code-to-the-hub"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a> <span>Hubë¡œ ì½”ë“œ ì—…ë¡œë“œí•˜ê¸°</span></h2>  <div class="course-tip course-tip-orange bg-gradient-to-br dark:bg-gradient-to-r before:border-orange-500 dark:before:border-orange-800 from-orange-50 dark:from-gray-900 to-white dark:to-gray-950 border border-orange-50 text-orange-700 dark:text-gray-400"><p data-svelte-h="svelte-11fial7">ì´ APIëŠ” ì‹¤í—˜ì ì´ë©° ë‹¤ìŒ ë¦´ë¦¬ìŠ¤ì—ì„œ ì•½ê°„ì˜ ë³€ê²½ ì‚¬í•­ì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p></div> <p data-svelte-h="svelte-q87di4">ë¨¼ì € ëª¨ë¸ì´ <code>.py</code> íŒŒì¼ì— ì™„ì „íˆ ì •ì˜ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.
ëª¨ë“  íŒŒì¼ì´ ë™ì¼í•œ ì‘ì—… ê²½ë¡œì— ìˆê¸° ë•Œë¬¸ì— ìƒëŒ€ê²½ë¡œ ì„í¬íŠ¸(relative import)ì— ì˜ì¡´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (transformersì—ì„œëŠ” ì´ ê¸°ëŠ¥ì— ëŒ€í•œ í•˜ìœ„ ëª¨ë“ˆì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤).
ì´ ì˜ˆì‹œì—ì„œëŠ” ì‘ì—… ê²½ë¡œ ì•ˆì˜ <code>resnet_model</code>ì—ì„œ <code>modeling_resnet.py</code> íŒŒì¼ê³¼ <code>configuration_resnet.py</code> íŒŒì¼ì„ ì •ì˜í•©ë‹ˆë‹¤.
êµ¬ì„± íŒŒì¼ì—ëŠ” <code>ResnetConfig</code>ì— ëŒ€í•œ ì½”ë“œê°€ ìˆê³  ëª¨ë¸ë§ íŒŒì¼ì—ëŠ” <code>ResnetModel</code> ë° <code>ResnetModelForImageClassification</code>ì— ëŒ€í•œ ì½”ë“œê°€ ìˆìŠµë‹ˆë‹¤.</p> <div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg> <div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div> Copied</div></button></div> <pre class=""><!-- HTML_TAG_START -->.
â””â”€â”€ resnet_model
    â”œâ”€â”€ __init__.<span class="hljs-keyword">py</span>
    â”œâ”€â”€ configuration_resnet.<span class="hljs-keyword">py</span>
    â””â”€â”€ modeling_resnet.<span class="hljs-keyword">py</span><!-- HTML_TAG_END --></pre></div> <p data-svelte-h="svelte-fw3tvd">Pythonì´ <code>resnet_model</code>ì„ ëª¨ë“ˆë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ê°ì§€í•˜ëŠ” ëª©ì ì´ê¸° ë•Œë¬¸ì— <code>__init__.py</code>ëŠ” ë¹„ì–´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>  <div class="course-tip course-tip-orange bg-gradient-to-br dark:bg-gradient-to-r before:border-orange-500 dark:before:border-orange-800 from-orange-50 dark:from-gray-900 to-white dark:to-gray-950 border border-orange-50 text-orange-700 dark:text-gray-400"><p data-svelte-h="svelte-1igyulw">ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ëª¨ë¸ë§ íŒŒì¼ì„ ë³µì‚¬í•˜ëŠ” ê²½ìš°,
ëª¨ë“  íŒŒì¼ ìƒë‹¨ì— ìˆëŠ” ìƒëŒ€ ê²½ë¡œ ì„í¬íŠ¸(relative import) ë¶€ë¶„ì„ <code>transformers</code> íŒ¨í‚¤ì§€ì—ì„œ ì„í¬íŠ¸ í•˜ë„ë¡ ë³€ê²½í•´ì•¼ í•©ë‹ˆë‹¤.</p></div> <p data-svelte-h="svelte-19tqquy">ê¸°ì¡´ êµ¬ì„±ì´ë‚˜ ëª¨ë¸ì„ ì¬ì‚¬ìš©(ë˜ëŠ” ì„œë¸Œ í´ë˜ìŠ¤í™”)í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p> <p data-svelte-h="svelte-1tgl3y3">ì»¤ë®¤ë‹ˆí‹°ì— ëª¨ë¸ì„ ê³µìœ í•˜ê¸° ìœ„í•´ì„œëŠ” ë‹¤ìŒ ë‹¨ê³„ë¥¼ ë”°ë¼ì•¼ í•©ë‹ˆë‹¤:
ë¨¼ì €, ìƒˆë¡œ ë§Œë“  íŒŒì¼ì— ResNet ëª¨ë¸ê³¼ êµ¬ì„±ì„ ì„í¬íŠ¸í•©ë‹ˆë‹¤:</p> <div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg> <div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div> Copied</div></button></div> <pre class=""><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> resnet_model.configuration_resnet <span class="hljs-keyword">import</span> ResnetConfig
<span class="hljs-keyword">from</span> resnet_model.modeling_resnet <span class="hljs-keyword">import</span> ResnetModel, ResnetModelForImageClassification<!-- HTML_TAG_END --></pre></div> <p data-svelte-h="svelte-85qz6h">ë‹¤ìŒìœ¼ë¡œ <code>save_pretrained</code> ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•´ í•´ë‹¹ ê°ì²´ì˜ ì½”ë“œ íŒŒì¼ì„ ë³µì‚¬í•˜ê³ ,
ë³µì‚¬í•œ íŒŒì¼ì„ Auto í´ë˜ìŠ¤ë¡œ ë“±ë¡í•˜ê³ (ëª¨ë¸ì¸ ê²½ìš°) ì‹¤í–‰í•©ë‹ˆë‹¤:</p> <div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg> <div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div> Copied</div></button></div> <pre class=""><!-- HTML_TAG_START -->ResnetConfig.register_for_auto_class()
ResnetModel.register_for_auto_class(<span class="hljs-string">&quot;AutoModel&quot;</span>)
ResnetModelForImageClassification.register_for_auto_class(<span class="hljs-string">&quot;AutoModelForImageClassification&quot;</span>)<!-- HTML_TAG_END --></pre></div> <p data-svelte-h="svelte-urqb2q"><code>configuration</code>ì— ëŒ€í•œ auto í´ë˜ìŠ¤ë¥¼ ì§€ì •í•  í•„ìš”ëŠ” ì—†ì§€ë§Œ(<code>configuration</code> ê´€ë ¨ auto í´ë˜ìŠ¤ëŠ” AutoConfig í´ë˜ìŠ¤ í•˜ë‚˜ë§Œ ìˆìŒ), ëª¨ë¸ì˜ ê²½ìš°ì—ëŠ” ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤.
ì‚¬ìš©ì ì§€ì • ëª¨ë¸ì€ ë‹¤ì–‘í•œ ì‘ì—…ì— ì í•©í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ëª¨ë¸ì— ë§ëŠ” auto í´ë˜ìŠ¤ë¥¼ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤.</p> <p data-svelte-h="svelte-th8o9z">ë‹¤ìŒìœ¼ë¡œ, ì´ì „ì— ì‘ì—…í–ˆë˜ ê²ƒê³¼ ë§ˆì°¬ê°€ì§€ë¡œ êµ¬ì„±ê³¼ ëª¨ë¸ì„ ì‘ì„±í•©ë‹ˆë‹¤:</p> <div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg> <div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div> Copied</div></button></div> <pre class=""><!-- HTML_TAG_START -->resnet50d_config = ResnetConfig(block_type=<span class="hljs-string">&quot;bottleneck&quot;</span>, stem_width=<span class="hljs-number">32</span>, stem_type=<span class="hljs-string">&quot;deep&quot;</span>, avg_down=<span class="hljs-literal">True</span>)
resnet50d = ResnetModelForImageClassification(resnet50d_config)

pretrained_model = timm.create_model(<span class="hljs-string">&quot;resnet50d&quot;</span>, pretrained=<span class="hljs-literal">True</span>)
resnet50d.model.load_state_dict(pretrained_model.state_dict())<!-- HTML_TAG_END --></pre></div> <p data-svelte-h="svelte-1xhzef1">ì´ì œ ëª¨ë¸ì„ Hubë¡œ ì—…ë¡œë“œí•˜ê¸° ìœ„í•´ ë¡œê·¸ì¸ ìƒíƒœì¸ì§€ í™•ì¸í•˜ì„¸ìš”.
í„°ë¯¸ë„ì—ì„œ ë‹¤ìŒ ì½”ë“œë¥¼ ì‹¤í–‰í•´ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p> <div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg> <div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div> Copied</div></button></div> <pre class=""><!-- HTML_TAG_START -->huggingface-cli login<!-- HTML_TAG_END --></pre></div> <p data-svelte-h="svelte-4bt266">ì£¼í”¼í„° ë…¸íŠ¸ë¶ì˜ ê²½ìš°ì—ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:</p> <div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg> <div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div> Copied</div></button></div> <pre class=""><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> huggingface_hub <span class="hljs-keyword">import</span> notebook_login

notebook_login()<!-- HTML_TAG_END --></pre></div> <p data-svelte-h="svelte-xc5sk0">ê·¸ëŸ° ë‹¤ìŒ ì´ë ‡ê²Œ ìì‹ ì˜ ë„¤ì„ìŠ¤í˜ì´ìŠ¤(ë˜ëŠ” ìì‹ ì´ ì†í•œ ì¡°ì§)ì— ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p> <div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg> <div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div> Copied</div></button></div> <pre class=""><!-- HTML_TAG_START -->resnet50d.push_to_hub(<span class="hljs-string">&quot;custom-resnet50d&quot;</span>)<!-- HTML_TAG_END --></pre></div> <p data-svelte-h="svelte-dnw5aw">On top of the modeling weights and the configuration in json format, this also copied the modeling and
configuration <code>.py</code> files in the folder <code>custom-resnet50d</code> and uploaded the result to the Hub. You can check the result
in this <a href="https://huggingface.co/sgugger/custom-resnet50d" rel="nofollow">model repo</a>.
json í˜•ì‹ì˜ ëª¨ë¸ë§ ê°€ì¤‘ì¹˜ì™€ êµ¬ì„± ì™¸ì—ë„ <code>custom-resnet50d</code> í´ë” ì•ˆì˜ ëª¨ë¸ë§ê³¼ êµ¬ì„± <code>.py</code> íŒŒì¼ì„ ë³µì‚¬í•˜í•´ Hubì— ì—…ë¡œë“œí•©ë‹ˆë‹¤.
<a href="https://huggingface.co/sgugger/custom-resnet50d" rel="nofollow">ëª¨ë¸ ì €ì¥ì†Œ</a>ì—ì„œ ê²°ê³¼ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p> <p data-svelte-h="svelte-2rsbbb"><a href="model_sharing">sharing tutorial</a> ë¬¸ì„œì˜ <code>push_to_hub</code> ë©”ì†Œë“œì—ì„œ ìì„¸í•œ ë‚´ìš©ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>  <h2 class="relative group"><a id="using-a-model-with-custom-code" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#using-a-model-with-custom-code"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a> <span>ì‚¬ìš©ì ì •ì˜ ì½”ë“œë¡œ ëª¨ë¸ ì‚¬ìš©í•˜ê¸°</span></h2> <p data-svelte-h="svelte-1m1cooj">auto í´ë˜ìŠ¤ì™€ <code>from_pretrained</code> ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ì ì§€ì • ì½”ë“œ íŒŒì¼ê³¼ í•¨ê»˜ ëª¨ë“  êµ¬ì„±, ëª¨ë¸, í† í¬ë‚˜ì´ì €ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
Hubì— ì—…ë¡œë“œëœ ëª¨ë“  íŒŒì¼ ë° ì½”ë“œëŠ” ë©œì›¨ì–´ê°€ ìˆëŠ”ì§€ ê²€ì‚¬ë˜ì§€ë§Œ (ìì„¸í•œ ë‚´ìš©ì€ <a href="https://huggingface.co/docs/hub/security#malware-scanning" rel="nofollow">Hub ë³´ì•ˆ</a> ì„¤ëª… ì°¸ì¡°),
ìì‹ ì˜ ì»´í“¨í„°ì—ì„œ ëª¨ë¸ ì½”ë“œì™€ ì‘ì„±ìê°€ ì•…ì„± ì½”ë“œë¥¼ ì‹¤í–‰í•˜ì§€ ì•ŠëŠ”ì§€ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤.
ì‚¬ìš©ì ì •ì˜ ì½”ë“œë¡œ ëª¨ë¸ì„ ì‚¬ìš©í•˜ë ¤ë©´ <code>trust_remote_code=True</code>ë¡œ ì„¤ì •í•˜ì„¸ìš”:</p> <div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg> <div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div> Copied</div></button></div> <pre class=""><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoModelForImageClassification

model = AutoModelForImageClassification.from_pretrained(<span class="hljs-string">&quot;sgugger/custom-resnet50d&quot;</span>, trust_remote_code=<span class="hljs-literal">True</span>)<!-- HTML_TAG_END --></pre></div> <p data-svelte-h="svelte-18oh14g">ëª¨ë¸ ì‘ì„±ìê°€ ì•…ì˜ì ìœ¼ë¡œ ì½”ë“œë¥¼ ì—…ë°ì´íŠ¸í•˜ì§€ ì•Šì•˜ë‹¤ëŠ” ì ì„ í™•ì¸í•˜ê¸° ìœ„í•´, ì»¤ë°‹ í•´ì‹œ(commit hash)ë¥¼ <code>revision</code>ìœ¼ë¡œ ì „ë‹¬í•˜ëŠ” ê²ƒë„ ê°•ë ¥íˆ ê¶Œì¥ë©ë‹ˆë‹¤ (ëª¨ë¸ ì‘ì„±ìë¥¼ ì™„ì „íˆ ì‹ ë¢°í•˜ì§€ ì•ŠëŠ” ê²½ìš°).</p> <div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg> <div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div> Copied</div></button></div> <pre class=""><!-- HTML_TAG_START -->commit_hash = <span class="hljs-string">&quot;ed94a7c6247d8aedce4647f00f20de6875b5b292&quot;</span>
model = AutoModelForImageClassification.from_pretrained(
    <span class="hljs-string">&quot;sgugger/custom-resnet50d&quot;</span>, trust_remote_code=<span class="hljs-literal">True</span>, revision=commit_hash
)<!-- HTML_TAG_END --></pre></div> <p data-svelte-h="svelte-eerkzr">Hubì—ì„œ ëª¨ë¸ ì €ì¥ì†Œì˜ ì»¤ë°‹ ê¸°ë¡ì„ ì°¾ì•„ë³¼ ë•Œ, ëª¨ë“  ì»¤ë°‹ì˜ ì»¤ë°‹ í•´ì‹œë¥¼ ì‰½ê²Œ ë³µì‚¬í•  ìˆ˜ ìˆëŠ” ë²„íŠ¼ì´ ìˆìŠµë‹ˆë‹¤.</p>  <h2 class="relative group"><a id="registering-a-model-with-custom-code-to-the-auto-classes" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#registering-a-model-with-custom-code-to-the-auto-classes"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a> <span>ì‚¬ìš©ì ì •ì˜ ì½”ë“œë¡œ ë§Œë“  ëª¨ë¸ì„ auto í´ë˜ìŠ¤ë¡œ ë“±ë¡í•˜ê¸°</span></h2> <p data-svelte-h="svelte-1w0yfzt">ğŸ¤— Transformersë¥¼ ìƒì†í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‘ì„±í•˜ëŠ” ê²½ìš° ì‚¬ìš©ì ì •ì˜ ëª¨ë¸ì„ auto í´ë˜ìŠ¤ì— ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì‚¬ìš©ì ì •ì˜ ëª¨ë¸ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ í•´ë‹¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„í¬íŠ¸í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì—, ì´ëŠ” Hubë¡œ ì½”ë“œë¥¼ ì—…ë¡œë“œí•˜ëŠ” ê²ƒê³¼ ë‹¤ë¦…ë‹ˆë‹¤ (Hubì—ì„œ ìë™ì ìœ¼ë¡œ ëª¨ë¸ ì½”ë“œë¥¼ ë‹¤ìš´ë¡œë“œ í•˜ëŠ” ê²ƒê³¼ ë°˜ëŒ€).</p> <p data-svelte-h="svelte-xh4cqs">êµ¬ì„±ì— ê¸°ì¡´ ëª¨ë¸ ìœ í˜•ê³¼ ë‹¤ë¥¸ <code>model_type</code> ì†ì„±ì´ ìˆê³  ëª¨ë¸ í´ë˜ìŠ¤ì— ì˜¬ë°”ë¥¸ <code>config_class</code> ì†ì„±ì´ ìˆëŠ” í•œ,
ë‹¤ìŒê³¼ ê°™ì´ auto í´ë˜ìŠ¤ì— ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p> <div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg> <div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div> Copied</div></button></div> <pre class=""><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoConfig, AutoModel, AutoModelForImageClassification

AutoConfig.register(<span class="hljs-string">&quot;resnet&quot;</span>, ResnetConfig)
AutoModel.register(ResnetConfig, ResnetModel)
AutoModelForImageClassification.register(ResnetConfig, ResnetModelForImageClassification)<!-- HTML_TAG_END --></pre></div> <p data-svelte-h="svelte-9j79lz">ì‚¬ìš©ì ì •ì˜ êµ¬ì„±ì„ <code>AutoConfig</code>ì— ë“±ë¡í•  ë•Œ ì‚¬ìš©ë˜ëŠ” ì²« ë²ˆì§¸ ì¸ìˆ˜ëŠ” ì‚¬ìš©ì ì •ì˜ êµ¬ì„±ì˜ <code>model_type</code>ê³¼ ì¼ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.
ë˜í•œ, ì‚¬ìš©ì ì •ì˜ ëª¨ë¸ì„ auto í´ë˜ìŠ¤ì— ë“±ë¡í•  ë•Œ ì‚¬ìš©ë˜ëŠ” ì²« ë²ˆì§¸ ì¸ìˆ˜ëŠ” í•´ë‹¹ ëª¨ë¸ì˜ <code>config_class</code>ì™€ ì¼ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.</p>  <p></p> 
			
			<script>
				{
					__sveltekit_1tvlkwq = {
						assets: "/docs/transformers/main/ko",
						base: "/docs/transformers/main/ko",
						env: {}
					};

					const element = document.currentScript.parentElement;

					const data = [null,null];

					Promise.all([
						import("/docs/transformers/main/ko/_app/immutable/entry/start.b52dcfcd.js"),
						import("/docs/transformers/main/ko/_app/immutable/entry/app.9c1dbc76.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 13],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		
